1. Do you think a secured network running in WPA2 pre-shared key mode using a strong random passphrase
is secure against connected clients sniffing traffic in the network? If so, why do you think so? If not,
explain in general terms the principle behind an attack.

---

Wi-Fi Protected Access II (WPA2) 
PSK - pre-shared key
TKIP - temporal key integrity protocol

The Wi-Fi Alliance refers to their approved, interoperable implementation of the full 802.11i as WPA2, also called RSN (Robust Security).

802.11i makes use of the Advanced Encryption Standard (AES) block cipher, whereas WEP and WPA use the RC4 stream cipher.[1]

WPA and WPA2 don't provide forward secrecy, meaning that once an adverse person discovers
the pre-shared key, they can potentially decrypt all packets encrypted using that PSK
transmitted in the future and even past, which could be passively and silently collected 
by the attacker.

This also means an attacker can silently capture and decrypt others' packets if a WPA-protected access point
is provided free of charge at a public place, because its password is usually shared to anyone in that place. 
In other words, WPA only protects from attackers who don't have access to the password. 
Because of that, it's safer to use Transport Layer Security (TLS) or similar on top of that for the transfer
of any sensitive data. However starting from WPA3, this issue has been addressed.
(https://en.wikipedia.org/wiki/Wi-Fi_Protected_Access)


The key exchange handshake process uses several pieces of information, some of which is transferred over the air
for the other device to make its necessary computations.
Including Pairwise Master Key (SSID, PSK), Authenticator Nonce (One-time key, generated by the Authenticator),
Supplicant Nonce (One-time key, generated by the Supplicant), Authenticator MAC Address and Supplicant MAC Address.
(https://www.surecloud.com/services/blog/the-risks-of-using-pre-shared-keys-for-wpawpa2-networks)

Rainbow table (https://en.wikipedia.org/wiki/Rainbow_table)
is precomputed table, used for reversing cryprtographic hash functions, usually for cracking password hashes. 

Essentially four problems with WPA2:
- weak passphrases
- WPA2 still supports TKIP
- many WPA2  routers support WiFi Protected Setup (WPS)
- Many users do not configure the certificates
(slides)



So, when the attacker obtains the public key, he can track, see and monitor everything. 
Strong passwords are therefore recommended (15+ random characters).

Brute forcing anz WPA password takes roughly 4h, since there is 11000 possibilities.
Pin is long 8 digits.